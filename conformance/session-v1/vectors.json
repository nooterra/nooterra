{
  "schemaVersion": "SessionArtifactConformanceCases.v1",
  "adapterProtocolVersion": "SessionArtifactConformanceRequest.v1",
  "fixtures": {
    "session_vectors_base_1": {
      "tenantId": "tenant_vectors",
      "session": {
        "schemaVersion": "Session.v1",
        "tenantId": "tenant_vectors",
        "sessionId": "sess_vectors_inbox_1",
        "visibility": "tenant",
        "participants": [
          "agt_orchestrator_1",
          "agt_worker_1"
        ],
        "metadata": {
          "workflowId": "wf_vectors_1",
          "objective": "conformance replay transcript determinism"
        },
        "createdAt": "2026-02-01T00:00:00.000Z",
        "updatedAt": "2026-02-01T00:00:03.000Z"
      },
      "events": [
        {
          "v": 1,
          "id": "ev_vectors_1",
          "at": "2026-02-01T00:00:01.000Z",
          "streamId": "sess_vectors_inbox_1",
          "type": "TASK_REQUESTED",
          "actor": {
            "type": "agent",
            "id": "agt_orchestrator_1"
          },
          "payload": {
            "schemaVersion": "SessionEvent.v1",
            "eventType": "TASK_REQUESTED",
            "at": "2026-02-01T00:00:01.000Z",
            "traceId": "trace_vectors_1",
            "provenance": {
              "schemaVersion": "SessionEventProvenance.v1",
              "label": "trusted",
              "derivedFromEventId": null,
              "isTainted": false,
              "taintDepth": 0,
              "explicitTaint": false,
              "reasonCodes": []
            },
            "body": {
              "taskId": "task_vectors_1",
              "prompt": "summarize sprint blockers"
            }
          },
          "payloadHash": "80bea1ea3129e79a1800aef831d8385b9ea9759915f17c0d851bf19f80e4f7bc",
          "prevChainHash": null,
          "chainHash": "49924e950c6fc553f565248e331f76860bd85d22b7b5ea058b9020754ebf291e",
          "signature": "AyPCfdYzAXwl5SfofOsdl6HNMBGweVt1wLs0iC8Sb1Y9AjhWm5sEf9t1aMu5ZzVBtQn2Wg6lkPJs4AMfnBmFAA==",
          "signerKeyId": "key_9ed38005b42d9364601ffab3"
        },
        {
          "v": 1,
          "id": "ev_vectors_2",
          "at": "2026-02-01T00:00:02.000Z",
          "streamId": "sess_vectors_inbox_1",
          "type": "TASK_PROGRESS",
          "actor": {
            "type": "agent",
            "id": "agt_worker_1"
          },
          "payload": {
            "schemaVersion": "SessionEvent.v1",
            "eventType": "TASK_PROGRESS",
            "at": "2026-02-01T00:00:02.000Z",
            "traceId": "trace_vectors_1",
            "provenance": {
              "schemaVersion": "SessionEventProvenance.v1",
              "label": "trusted",
              "derivedFromEventId": "ev_vectors_1",
              "isTainted": false,
              "taintDepth": 0,
              "explicitTaint": false,
              "reasonCodes": []
            },
            "body": {
              "progressPct": 65,
              "note": "gathered evidence refs"
            }
          },
          "payloadHash": "0b0d48661cd6b74bd6d736aafee61fb9f9b4caecf5819ad944371d9b5a78bd09",
          "prevChainHash": "49924e950c6fc553f565248e331f76860bd85d22b7b5ea058b9020754ebf291e",
          "chainHash": "8a03365658dd2f25abbb6666fd72fed4342c705c2162b414ee30c64ecbea9bb7",
          "signature": "dwCUD/T4C8HoBJ+DLorERJFqyIb0yOyTIIQshI+k6sNPLakvMVgqAhcjt5FSKhMqVXicjzSRelKaSE8ZOBGZAA==",
          "signerKeyId": "key_9ed38005b42d9364601ffab3"
        },
        {
          "v": 1,
          "id": "ev_vectors_3",
          "at": "2026-02-01T00:00:03.000Z",
          "streamId": "sess_vectors_inbox_1",
          "type": "TASK_COMPLETED",
          "actor": {
            "type": "agent",
            "id": "agt_worker_1"
          },
          "payload": {
            "schemaVersion": "SessionEvent.v1",
            "eventType": "TASK_COMPLETED",
            "at": "2026-02-01T00:00:03.000Z",
            "traceId": "trace_vectors_1",
            "provenance": {
              "schemaVersion": "SessionEventProvenance.v1",
              "label": "trusted",
              "derivedFromEventId": "ev_vectors_2",
              "isTainted": false,
              "taintDepth": 0,
              "explicitTaint": false,
              "reasonCodes": []
            },
            "body": {
              "outputRef": "artifact://vectors/output/summary.md",
              "checksumSha256": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            }
          },
          "payloadHash": "b214225d1fa5a84f6d151f29671646eb48a7da923753d54270fc34999c83ed3a",
          "prevChainHash": "8a03365658dd2f25abbb6666fd72fed4342c705c2162b414ee30c64ecbea9bb7",
          "chainHash": "059428149249fd44f9e9f27ef3731cd5b803c63a3ee289f86daf61f8bb4c7141",
          "signature": "Vld72d9UwFgpNltjJVAUe/biMhPHP/sf87p6E8LlWV6NYztoovjhCSh42l8h+UdD+M5QqEWZpw3gVL58UOEiCg==",
          "signerKeyId": "key_9ed38005b42d9364601ffab3"
        }
      ],
      "verification": {
        "chainOk": true,
        "verifiedEventCount": 3,
        "error": null,
        "provenance": {
          "ok": true,
          "verifiedEventCount": 3,
          "taintedEventCount": 0,
          "error": null
        }
      }
    },
    "session_vectors_acl_denied_1": {
      "tenantId": "tenant_vectors",
      "session": {
        "schemaVersion": "Session.v1",
        "tenantId": "tenant_vectors",
        "sessionId": "sess_vectors_acl_1",
        "visibility": "tenant",
        "participants": [
          "agt_orchestrator_1",
          "agt_worker_1"
        ],
        "metadata": {
          "workflowId": "wf_vectors_acl_1",
          "objective": "conformance replay ACL deny fail-closed"
        },
        "createdAt": "2026-02-01T00:00:00.000Z",
        "updatedAt": "2026-02-01T00:00:01.000Z"
      },
      "events": [
        {
          "v": 1,
          "id": "ev_vectors_acl_1",
          "at": "2026-02-01T00:00:01.000Z",
          "streamId": "sess_vectors_acl_1",
          "type": "TASK_REQUESTED",
          "actor": {
            "type": "agent",
            "id": "agt_orchestrator_1"
          },
          "payload": {
            "schemaVersion": "SessionEvent.v1",
            "eventType": "TASK_REQUESTED",
            "at": "2026-02-01T00:00:01.000Z",
            "traceId": "trace_vectors_acl_1",
            "provenance": {
              "schemaVersion": "SessionEventProvenance.v1",
              "label": "trusted",
              "derivedFromEventId": null,
              "isTainted": false,
              "taintDepth": 0,
              "explicitTaint": false,
              "reasonCodes": []
            },
            "body": {
              "taskId": "task_vectors_acl_1",
              "prompt": "acl denied conformance fixture"
            }
          },
          "payloadHash": "70b6115c8ebdff7dad95489173851d57bcd4fc6be84dc17ce3d17f3be14ecd4e",
          "prevChainHash": null,
          "chainHash": "3b12df4b5d588de369304c00ec6ef7f95bd652f8d4b2408aa55a59c01f471f6d",
          "signature": "AyPCfdYzAXwl5SfofOsdl6HNMBGweVt1wLs0iC8Sb1Y9AjhWm5sEf9t1aMu5ZzVBtQn2Wg6lkPJs4AMfnBmFAA==",
          "signerKeyId": "key_9ed38005b42d9364601ffab3"
        }
      ],
      "verification": {
        "chainOk": true,
        "verifiedEventCount": 1,
        "error": null,
        "provenance": {
          "ok": true,
          "verifiedEventCount": 1,
          "taintedEventCount": 0,
          "error": null
        }
      },
      "acl": {
        "principalId": "agt_intruder_1",
        "participants": [
          "agt_orchestrator_1",
          "agt_worker_1"
        ]
      }
    },
    "session_vectors_chain_invalid_1": {
      "tenantId": "tenant_vectors",
      "session": {
        "schemaVersion": "Session.v1",
        "tenantId": "tenant_vectors",
        "sessionId": "sess_vectors_chain_invalid_1",
        "visibility": "tenant",
        "participants": [
          "agt_orchestrator_1",
          "agt_worker_1"
        ],
        "metadata": {
          "workflowId": "wf_vectors_chain_invalid_1",
          "objective": "conformance replay chain invalid fail-closed"
        },
        "createdAt": "2026-02-01T00:00:00.000Z",
        "updatedAt": "2026-02-01T00:00:01.000Z"
      },
      "events": [
        {
          "v": 1,
          "id": "ev_vectors_chain_invalid_1",
          "at": "2026-02-01T00:00:01.000Z",
          "streamId": "sess_vectors_chain_invalid_1",
          "type": "TASK_REQUESTED",
          "actor": {
            "type": "agent",
            "id": "agt_orchestrator_1"
          },
          "payload": {
            "schemaVersion": "SessionEvent.v1",
            "eventType": "TASK_REQUESTED",
            "at": "2026-02-01T00:00:01.000Z",
            "traceId": "trace_vectors_chain_invalid_1",
            "provenance": {
              "schemaVersion": "SessionEventProvenance.v1",
              "label": "trusted",
              "derivedFromEventId": null,
              "isTainted": false,
              "taintDepth": 0,
              "explicitTaint": false,
              "reasonCodes": []
            },
            "body": {
              "taskId": "task_vectors_chain_invalid_1",
              "prompt": "chain invalid conformance fixture"
            }
          },
          "payloadHash": "57d96f9dc5600e85f60ddfca9f657e1efff27183e64f2f8c9a0213f485df91ca",
          "prevChainHash": null,
          "chainHash": "12f07e2c9467f49790ae4f37e1200821297fbc2f49a8dca24dce2f4ad6c8ef77",
          "signature": "AyPCfdYzAXwl5SfofOsdl6HNMBGweVt1wLs0iC8Sb1Y9AjhWm5sEf9t1aMu5ZzVBtQn2Wg6lkPJs4AMfnBmFAA==",
          "signerKeyId": "key_9ed38005b42d9364601ffab3"
        }
      ],
      "verification": {
        "chainOk": false,
        "verifiedEventCount": 0,
        "error": "chain hash mismatch at ev_vectors_chain_invalid_1",
        "provenance": {
          "ok": true,
          "verifiedEventCount": 1,
          "taintedEventCount": 0,
          "error": null
        }
      }
    },
    "session_vectors_provenance_invalid_1": {
      "tenantId": "tenant_vectors",
      "session": {
        "schemaVersion": "Session.v1",
        "tenantId": "tenant_vectors",
        "sessionId": "sess_vectors_provenance_invalid_1",
        "visibility": "tenant",
        "participants": [
          "agt_orchestrator_1",
          "agt_worker_1"
        ],
        "metadata": {
          "workflowId": "wf_vectors_provenance_invalid_1",
          "objective": "conformance replay provenance invalid fail-closed"
        },
        "createdAt": "2026-02-01T00:00:00.000Z",
        "updatedAt": "2026-02-01T00:00:01.000Z"
      },
      "events": [
        {
          "v": 1,
          "id": "ev_vectors_provenance_invalid_1",
          "at": "2026-02-01T00:00:01.000Z",
          "streamId": "sess_vectors_provenance_invalid_1",
          "type": "TASK_REQUESTED",
          "actor": {
            "type": "agent",
            "id": "agt_orchestrator_1"
          },
          "payload": {
            "schemaVersion": "SessionEvent.v1",
            "eventType": "TASK_REQUESTED",
            "at": "2026-02-01T00:00:01.000Z",
            "traceId": "trace_vectors_provenance_invalid_1",
            "provenance": {
              "schemaVersion": "SessionEventProvenance.v1",
              "label": "trusted",
              "derivedFromEventId": null,
              "isTainted": false,
              "taintDepth": 0,
              "explicitTaint": false,
              "reasonCodes": []
            },
            "body": {
              "taskId": "task_vectors_provenance_invalid_1",
              "prompt": "provenance invalid conformance fixture"
            }
          },
          "payloadHash": "dc71a1056f8c88f6caec2f41cfffd8fc9f3e3f18bf18879ecbc25812e6a8d873",
          "prevChainHash": null,
          "chainHash": "0ace3b07639d3f1718d3c5de90f2d59f52cc06ff8a1f5ec7f8f3c5d5db8f768f",
          "signature": "AyPCfdYzAXwl5SfofOsdl6HNMBGweVt1wLs0iC8Sb1Y9AjhWm5sEf9t1aMu5ZzVBtQn2Wg6lkPJs4AMfnBmFAA==",
          "signerKeyId": "key_9ed38005b42d9364601ffab3"
        }
      ],
      "verification": {
        "chainOk": true,
        "verifiedEventCount": 1,
        "error": null,
        "provenance": {
          "ok": false,
          "verifiedEventCount": 0,
          "taintedEventCount": 1,
          "error": "ambiguous provenance trust declaration"
        }
      }
    }
  },
  "cases": [
    {
      "id": "session_artifacts_unsigned_deterministic",
      "fixtureId": "session_vectors_base_1",
      "invariantIds": [
        "ACS-NS2-REPLAY-DETERMINISM",
        "ACS-NS2-TRANSCRIPT-DETERMINISM"
      ],
      "signing": null,
      "expected": {
        "eventCount": 3,
        "generatedAt": "2026-02-01T00:00:03.000Z",
        "replayPackHash": "a0dd69f24ee702c8c921156acaaddefa2694f103f4bd5d458e7898c662bf05f9",
        "transcriptHash": "f5c2ab75640612db1890cd22a94e1e19f883c1a77fbeb12afd5b91076ce0ae55",
        "replaySignaturePresent": false,
        "transcriptSignaturePresent": false
      }
    },
    {
      "id": "session_artifacts_signed_deterministic",
      "fixtureId": "session_vectors_base_1",
      "invariantIds": [
        "ACS-NS2-REPLAY-DETERMINISM",
        "ACS-NS2-TRANSCRIPT-DETERMINISM",
        "ACS-NS2-SIGNED-ARTIFACT-VERIFY"
      ],
      "signing": {
        "keyId": "key_9ed38005b42d9364601ffab3",
        "publicKeyPem": "-----BEGIN PUBLIC KEY-----\nMCowBQYDK2VwAyEAQ70D1FtwopWnvJeFsiKdThSP/9QADgSeaZYKip79KQI=\n-----END PUBLIC KEY-----\n",
        "privateKeyPem": "-----BEGIN PRIVATE KEY-----\nMC4CAQAwBQYDK2VwBCIEILP0SvKxPshPvhk7qDsIZPZTTQiy3RG+aX9dOG9+VL3F\n-----END PRIVATE KEY-----\n"
      },
      "expected": {
        "eventCount": 3,
        "generatedAt": "2026-02-01T00:00:03.000Z",
        "replayPackHash": "a0dd69f24ee702c8c921156acaaddefa2694f103f4bd5d458e7898c662bf05f9",
        "transcriptHash": "f5c2ab75640612db1890cd22a94e1e19f883c1a77fbeb12afd5b91076ce0ae55",
        "replaySignaturePresent": true,
        "transcriptSignaturePresent": true,
        "replaySignatureBase64": "XyxiyukKIkjd6XYz2Ul8TktbBVml7VpVVy7jsNCA/ZqsLfTORp19DiNRpp8X7D9/TUBuBLJBKSfXpQjNUQzUCA==",
        "transcriptSignatureBase64": "S2zWGzbyOFidpz5ULZwS8BmWmJ9W8jtw9DObmVFS/E3ncZxshWDbFH84X4q02iGpeaJcyZObq/rqb1GNZXVVDw=="
      }
    },
    {
      "id": "session_artifacts_acl_denied_fail_closed",
      "fixtureId": "session_vectors_acl_denied_1",
      "invariantIds": [
        "ACS-NS2-SESSION-REPLAY-ACL-DENY",
        "ACS-NS2-SESSION-TRANSCRIPT-ACL-DENY"
      ],
      "signing": null,
      "expected": {
        "outcome": "fail",
        "code": "SESSION_ACCESS_DENIED",
        "message": "session access denied",
        "details": {
          "sessionId": "sess_vectors_acl_1",
          "principalId": "agt_intruder_1",
          "participants": [
            "agt_orchestrator_1",
            "agt_worker_1"
          ]
        }
      }
    },
    {
      "id": "session_artifacts_chain_invalid_fail_closed",
      "fixtureId": "session_vectors_chain_invalid_1",
      "invariantIds": [
        "ACS-NS2-SESSION-REPLAY-CHAIN-INVALID"
      ],
      "signing": null,
      "expected": {
        "outcome": "fail",
        "code": "SESSION_REPLAY_CHAIN_INVALID",
        "message": "session replay chain invalid",
        "details": {
          "sessionId": "sess_vectors_chain_invalid_1",
          "reason": "chain hash mismatch at ev_vectors_chain_invalid_1"
        }
      }
    },
    {
      "id": "session_artifacts_provenance_invalid_fail_closed",
      "fixtureId": "session_vectors_provenance_invalid_1",
      "invariantIds": [
        "ACS-NS2-SESSION-REPLAY-PROVENANCE-INVALID"
      ],
      "signing": null,
      "expected": {
        "outcome": "fail",
        "code": "SESSION_REPLAY_PROVENANCE_INVALID",
        "message": "session replay provenance invalid",
        "details": {
          "sessionId": "sess_vectors_provenance_invalid_1",
          "reason": "ambiguous provenance trust declaration"
        }
      }
    }
  ]
}
