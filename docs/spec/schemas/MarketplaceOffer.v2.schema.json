{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://nooterra.local/schemas/MarketplaceOffer.v2.schema.json",
  "title": "MarketplaceOffer.v2",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schemaVersion",
    "offerId",
    "tenantId",
    "rfqId",
    "runId",
    "bidId",
    "proposalId",
    "revision",
    "proposerAgentId",
    "amountCents",
    "currency",
    "etaSeconds",
    "note",
    "verificationMethod",
    "policy",
    "policyRef",
    "policyRefHash",
    "prevProposalHash",
    "proposalHash",
    "offerChainHash",
    "proposalCount",
    "metadata",
    "proposedAt",
    "createdAt",
    "offerHash"
  ],
  "properties": {
    "schemaVersion": { "const": "MarketplaceOffer.v2" },
    "offerId": { "type": "string", "minLength": 1, "maxLength": 300 },
    "tenantId": { "type": "string", "minLength": 1, "maxLength": 128, "pattern": "^[A-Za-z0-9:_-]+$" },
    "rfqId": { "type": "string", "minLength": 1, "maxLength": 300 },
    "runId": { "type": ["string", "null"], "minLength": 1, "maxLength": 300 },
    "bidId": { "type": "string", "minLength": 1, "maxLength": 300 },
    "proposalId": { "type": ["string", "null"], "minLength": 1, "maxLength": 300 },
    "revision": { "type": "integer", "minimum": 1 },
    "proposerAgentId": { "type": ["string", "null"], "minLength": 1, "maxLength": 300 },
    "amountCents": { "type": "integer", "minimum": 1 },
    "currency": { "type": "string", "minLength": 3, "maxLength": 12, "pattern": "^[A-Z][A-Z0-9_]{2,11}$" },
    "etaSeconds": { "type": ["integer", "null"], "minimum": 1 },
    "note": { "type": ["string", "null"], "maxLength": 4000 },
    "verificationMethod": { "type": ["object", "null"], "additionalProperties": true },
    "policy": { "type": ["object", "null"], "additionalProperties": true },
    "policyRef": { "type": ["object", "null"], "additionalProperties": true },
    "policyRefHash": { "type": ["string", "null"], "pattern": "^[0-9a-f]{64}$" },
    "prevProposalHash": { "type": ["string", "null"], "pattern": "^[0-9a-f]{64}$" },
    "proposalHash": { "type": "string", "pattern": "^[0-9a-f]{64}$" },
    "offerChainHash": { "type": ["string", "null"], "pattern": "^[0-9a-f]{64}$" },
    "proposalCount": { "type": ["integer", "null"], "minimum": 1 },
    "metadata": { "type": ["object", "null"], "additionalProperties": true },
    "proposedAt": { "type": "string", "format": "date-time" },
    "createdAt": { "type": "string", "format": "date-time" },
    "offerHash": { "type": "string", "pattern": "^[0-9a-f]{64}$" }
  }
}
